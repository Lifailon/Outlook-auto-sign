## Outlook-auto-sign - автоматическое создание подписи в Outlook 2016-2021.

Инструкция по создания и алгоритму работы скрипта:

Необходимо единоразово создать подпись в ручную через форму Outlook, где можно указать свой цвет и шрифт (не прибегая к синтексису html). В дальнейшем готовый шаблон необходимо расположить в общедоступном месте по сети.

> Пример находится в репозитории (auto.htm), который можно взять за основу, для удобства сократил до одного файла (содержимое тега <style> необходимо оставить по умолчанию, иначе едет межстрочный интервал). **Необходимо указать свой unc-путь в переменной $path_domain (строка 19) до файла с подписью.** В моем случае ссылается на линк DFS, для этого используется переменная имени текущего домена в начале пути.

![Image alt](https://github.com/Lifailon/Outlook-auto-sign/blob/rsa/Creat%20signature.jpg)

### Скрипт:

* 1-й блок. Забирает имя текущего пользователя, которое используется для поиска в фильтре при запросе LDAP (дочерний модуль сборки System.DirectoryServices), и вытаскивает содержимое cвойств объекта AD.
* 2-й блок. Копирует готовый шаблон подписи из общедоступной директории в локальную директорию подписей outlook текущего пользователя.
* 3-й блок. Забирает содержимое файлов подписи, производить парсинг и перезаписывает файлы (можно сократить, оставил для удобства читабельности и правки).
* 4-й блок. Устанавливает добавленную подпись по умолчанию через реест, используя имя (в примере, auto). Для поиска изменений ключей в реестре можно использовать RegistryChangesView или Regshot, пример:

![Image alt](https://github.com/Lifailon/Outlook-auto-sign/blob/rsa/Find%20change%20regedit.jpg)
